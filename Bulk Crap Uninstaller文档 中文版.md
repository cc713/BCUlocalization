- [1 介绍](#1 介绍)
- [2 主窗口](#2 主窗口)
- [3 应用程序属性](#3 应用程序属性)
- [4 设置](#4 设置)
- [5 高级复制到剪贴板](#5 高级复制到剪贴板)
- [6 高级筛选 / 卸载列表](#6 高级筛选 / 卸载列表)
- [7 卸载](#7 卸载)
- [8 自定义规则, 脚本 和 调整](#8 自定义规则, 脚本 和 调整)
- [9 命令行选项](#9 命令行选项)

# 1 介绍

Bulk Crap Uninstaller (或 BCUninstaller) 是一个自由的程序卸载程序. 它擅长用最少的用户输入删除大量的应用程序. 它可以清理残余，检测孤立的应用程序，根据预先制作的列表运行卸载程序，还有更多!

BCU与Windows商店应用, Steam, Windows功能完全兼容, 并对许多卸载系统(NSIS, InnoSetup, Msiexec和许多其他系统)具有特殊支持.完整的功能列表见下.

Bulk Crap Uninstaller是在Apache 2.0开源许可下授权的, 可以在私有和商业环境中免费使用, 并且没有任何义务, 只要不违反许可证的任何条件.

官方网站和联系方式见 https://www.bcuninstaller.com/

获取最新版本或查看代码见 https://github.com/Klocman/Bulk-Crap-Uninstaller

## 1.1 系统要求

- 操作系统: 推荐Windows Vista以上. BCU也能在XP 和 2003 上运行, 但功能较少且可能有些bug. 支持32位 和 64位 版本. 

- .NET: 推荐 .NET 4.0 以上, .NET 3.5上只能使用部分功能. 

- 内存: 约 300MB 或更多闲置RAM. 

- CPU: 不重要. 

- 可用空间: 50MB 以上. 

- 硬盘: 无要求, 但是较慢的驱动器会使扫描时间成比例地延长. 

BCUninstaller **需要以管理员权限启动** 和使用. 管理员权限用于在应用程序扫描期间访问一些系统功能, 卸载应用程序和删除残余内容. 某些其他功能可能还需要提升权限才能运行，因此无法使用普通用户权限运行BCU。

# 2 主窗口

![](https://user-images.githubusercontent.com/85151140/122630135-531ded80-d0f4-11eb-8767-247b9aafd01f.png)

## 2.1 应用程序列表

BCU设法在系统中找到的应用程序列表占据了主窗口的大部分. 列表可以按列排序, 并使用左侧的选项进行筛选.

### 2.1.1 突出显示颜色

默认情况下, 列表中的许多项根据其属性具有彩色背景. 它们的含义可以在右下角的颜色图例中找到. 如果列表不可见, 可以从"视图"菜单启用.

白色背景的项没有特殊属性.

### 2.1.2 证书和验证

BCU 可以读取和验证卸载程序的证书. 可以在"属性"窗口中查看它们的详细信息. 这一功能**不**表示应用程序的好坏，仅用作提示。
已验证的证书意味着可执行文件保证在离开发布者后未以任何方式被修改.

以下情况可能导致证书验证失败:

- 由于根证书无效或无法连接internet, 无法验证证书.

- 在某个时刻, 可执行文件被以某种方式修改了. 这对于Windows Installer(MSI/MsiExec)卸载程序是正常的 – 系统会修改它们以节省磁盘空间.

- 证书已自签名, 因此无法验证.

- 已签名的文件在通过internet的过程中已被修改/损坏. 

### 2.1.3 用户评分

大多数应用程序都可以由BCU的用户进行评分. 评分将自动与统计服务器同步. 等级可以在0到4颗星之间, 星星的颜色与它们的数量相对应.

如果星星是黑色的, 这意味着它们代表你自己的投票, 而不是用户的平均值. 你可以在星星上悬停以查看平均评分.

## 2.2 左侧边栏

设置侧边栏主要包含应用程序列表的筛选选项。它可以从“视图”菜单中隐藏.

搜索框与高级筛选中使用的条件相同, 详情见[6.3条件].

如果启用了高级筛选, 则侧边栏将自动隐藏.

## 2.3 树状矩形图

在应用程序的底部,状态栏的正上方,应该会看到一堆彩色瓷砖. 这是一个树状结构矩形图–列表中当前可见的所有应用程序的可视化表示.

方块的大小基于应用程序的估计大小. 如果应用程序没有估计大小, 则不会显示.瓷砖是使用非线性算法缩放的 - 大小差异看起来会比实际更小.

你可以将鼠标悬停在树状矩形图上, 当前光标下的应用程序将显示在下面. 你可以单击任意瓷砖并右键单击以打开上下文菜单, 左键单击以选择应用程序. 它的工作原理与主列表相同. 选定的瓷砖将更改为选定颜色.

## 2.4 功能

### 2.4.1 卸载 / 静默卸载

开始卸载选定的应用程序. 静默卸载意味着你不必点击任何东西 – 这个过程是自动的. 如果无法静默卸载某些项目, 将显示一个对话框, 可以从选择中删除“显式”的卸载程序.

### 2.4.2 使用MsiExec / Windows Installer卸载

如果应用程序附加了产品代码/GUID, 可以尝试使用MsiExec卸载它. 它不能保证在所有应用程序上都能工作.

### 2.4.3 手动卸载

跳过运行卸载程序(如果可用), 而是提供一个文件和注册表项列表, 可以选择手动删除.

除非无法以其他方式卸载应用程序, 否则不建议使用此方法.

### 2.4.4 清理“Program Files”文件夹

搜索所有定义为默认安装位置的文件夹(通常仅Program Files文件夹)以查找残余内容. 这包括空文件夹和部分卸载的应用程序. 你可以选择要删除的项目。

### 2.4.5 通过窗口查找

打开一个小工具窗口. 将十字线拖放到要扫描的窗口上. BCU将尝试查找拥有指定窗口的应用程序, 并将其显示在列表中.

### 2.4.6 卸载Windows功能

扫描系统中已安装的Windows功能, 并将其添加到应用程序列表中. 此后, 它们被视为普通应用程序, 可以批量卸载. 扫描可能需要一段时间.

# 3 应用程序属性

某些属性显示为背景色, 详情见[2.1.1 突出显示颜色](###2.1.1 突出显示颜色).

"属性"窗口中提供了列表中未显示的其他信息.

## 3.1 卸载程序丢失

应用程序已在系统注册表中注册, 但其卸载程序已损坏或丢失. 必须手动删除.

## 3.2 未注册的应用程序

应用程序未在系统注册表中注册, 但存在于驱动器上. 如果应用程序仍然有一个可用的卸载程序, BCU通常可以设法找到它并让你运行它. 如果找不到卸载程序, BCU将自动生成一个简单的卸载程序.

## 3.3 受保护

应用程序在系统注册表中被标记为受保护. 这通常用于表示它是另一个包的一部分, 或者是其他应用程序所需要的.

## 3.4 商店应用

新的Windows 10风格的应用程序都被称为商店应用, 即使它们不来自Windows商店. 它们通常需要完全不同的卸载方法, 但BCU将其作为正常应用.

## 3.5 系统组件

应用程序被标记为在某种程度上对系统很重要. 驱动程序和较大软件包的组件通常被标记为系统组件, 以对用户隐藏它们. 它们实际上不是操作系统所需要的.

## 3.6 更新

表示该项是对另一个应用程序或操作系统的更新. 卸载实际应用程序通常会自动删除所有相关更新.

# 4 设置

设置将在应用程序退出时自动应用和保存. 可以通过"帮助\重置设置"菜单选项或删除BCU目录中"BCUninstaller.settings"文件将设置重置为默认值.

## 4.1 卸载

- 阻止关机/重启 将尝试阻止卸载程序重启系统. 

- 智能卸载程序排序 将在批量卸载期间对应用程序进行排序, 以加快此过程. 它将首先处理显式卸载程序, 以便你可以更早地离开计算机.

- 禁用保护 将停止阻止受保护的应用程序卸载. 

- 打开“模拟卸载”将阻止BCU卸载或从系统中删除任何内容.

### 4.1.1 同时卸载

同时卸载是一项实验性功能, 它将安排多个卸载程序同时运行. 它将尽最大努力防止任何冲突, 有时此功能将完全不可用.

除非你使用的是高速的SSD, 否则不建议同时运行两个以上的卸载程序.

可以从"批量卸载"窗口手动强制卸载程序同时运行. 这样做仍将测试冲突,但可以禁用检查(不推荐).

# 5 高级复制到剪贴板

模式是[复合格式字符串](https://msdn.microsoft.com/en-us/library/txafckwd(v=vs.110).aspx) 写入时自动处理.

要启用转义字符(\r, \t, \n, etc.) 启用“转义”复选框. 它将任何转义字符转换为它们的非转义形式.

若要插入换行符, 请将 "\r\n"(Windows 上的标准换行符)添加到模式并启用 "转义". 你应该看到换行符出现在结果框中.

组合框包含可以添加到模式的所有可用变量. 选择其中一个变量将自动将其粘贴到光标位置.

# 6 高级筛选 / 卸载列表

![](https://user-images.githubusercontent.com/85151140/122630152-64ff9080-d0f4-11eb-9e4f-ebe619065625.png)

## 6.1 启用高级筛选

可以通过单击侧边栏上的"高级按钮"或从"文件"菜单打开现有的卸载列表来启用高级筛选.

如果加载了卸载列表, 其路径将显示在应用程序的标题栏中.

启用高级筛选时, 将忽略所有基本筛选设置.

## 6.2 筛选器

筛选器显示在"筛选器列表"中. 每个筛选器可以包含多个条件.

可以通过工具栏上的选项从现有卸载列表中添加筛选器. 新筛选器将附加到列表的末尾.

如果过滤器的类型设置为包括, 则只允许与所有条件匹配的应用程序出现在列表中. 它们在排除筛选器之前执行.

如果将类型设置为排除, 则筛选器将从列表中删除与其所有条件匹配的所有应用程序. 它们覆盖包括筛选器.

如果只有排除筛选器, 则所有应用程序都将自动包括在内.

## 6.3 条件

要使筛选器与应用程序匹配, 其所有条件都必须与之匹配. 如果任何一个条件与应用程序不匹配, 则整个筛选器将不匹配.

使用选定的比较方法将筛选器文本与目标属性进行比较. 比较的结果可以选择反转(否定).

### 6.3.1 比较方法

- 包含 – 属性包含整个筛选器文本. 

- 包含任一 – 属性包含筛选器文本中的任何单词. 它们之间用空格隔开.

- 完全相同 – 属性与筛选器文本完全相同. 

- 开头是 / 结尾是 – 属性以筛选器文本开头或结尾. 

- 正则表达式 – 使用正则表达式引擎将筛选器文本与属性匹配. [正则表达式在线手册](http://www.regular-expressions.info/). 

### 6.3.2 目标属性

将与之进行比较的应用程序的属性. "所有属性"将尝试将筛选器文本与任何可用属性匹配.

可以通过查看应用程序的属性来预览属性.

## 6.4 通过.bcul文件保存和加载筛选器

.bcul 文件(也称为"高级筛选器列表"或"卸载列表")用于存储高级筛选器信息以供以后使用. 你可以将筛选器集保存到一个 .bcul 文件中, 以后可以与命令行工具一起使用该文件自动卸载与筛选器匹配的所有应用程序.

要保存 .bcul 文件, 请首先打开“高级筛选器”面板, 指定筛选器, 然后单击筛选器列表上方工具栏中的"另存为…"按钮.你应该会看到一个扩展名为.bcul的保存文件对话框.

要加载 .bcul 文件, 请单击”文件“>”打开卸载列表…", 或打开高级筛选器面板并单击"打开…"工具栏项.

通过命令行工具使用.bcul文件自动卸载应用程序(例如在脚本中), 见[BCU-console.exe 参数列表](##9.2 BCU-console.exe).

# 7 卸载

BCU可以同时卸载单个或多个应用程序. 要卸载, 请在主列表中选择要卸载的应用程序(可以通过按住 shift 或 control 键选择多个应用程序), 然后单击上面工具栏上的"静默卸载/卸载"按钮, 或者右键单击所选内容并在上下文菜单中选择"静默卸载/卸载".

如果你卸载了任何集成到系统中的应用程序(如驱动程序, 扩展程序, 杀毒软件), 则应在BCU完成卸载后重启电脑, 以确保所有内容都被完全删除(有些卸载程序在重新启动后继续运行, 而在其他情况下, Windows仍在使用某些文件, 因此必须在下次系统启动时删除这些文件).

## 7.1 显式 / 静默卸载程序

卸载应用程序有两种方法 – 显式和静默.

- 显式卸载指的是一个卸载程序, 它要求用户点击几个屏幕(通过点击"下一步","完成"等按钮)来完成卸载.

- 另一方面, 静默卸载不需要用户输入即可完成, 正因如此更容易处理, 可以更快地完成.

BCU能够使用多种技术(如UI自动化)为许多应用程序生成静默卸载程序.

## 7.2 准备工作

在点击任何一个卸载按钮之后, 你可能会被问一些问题, 尤其是:

- 是否应将显式卸载程序从静默的任务中删除.

- 是否应从任务中删除受保护的项目(仅当在"设置"中启用了保护时).

- BCU是否应在运行任务之前创建系统还原点.

- BCU是否应终止可能会干扰运行任务的应用程序(见下).   

### 7.2.1 进程终止窗口

![](https://user-images.githubusercontent.com/85151140/122630168-7ba5e780-d0f4-11eb-8821-84179549c4ee.png)

如果有任何正在运行的应用程序可能正在使用将在任务中卸载的文件, 则会显示上述窗口. 建议将它们全部关闭, 但可能出现误报 – 千万注意, 以免丢失打开的工作.

## 7.3 卸载进度窗口

![](https://user-images.githubusercontent.com/85151140/122630173-8a8c9a00-d0f4-11eb-82de-a2925191aa2f.png)

卸载进度窗口将显示配置后的卸载进度. 卸载程序按以下类别分组:

- 卸载中 – 卸载程序此时正在运行. 如果多个卸载程序之间没有冲突, 那么它们可以同时运行. 可以在设置中更改此行为. 

- 等待中 – 卸载程序正在等待执行. 

- 已完成 – 卸载程序似乎已成功完成. 

- 失败 – 卸载程序无法运行或完成. 如果可能, 提供故障原因. 

- 已跳过 – 卸载程序被用户跳过. 如果可能的话, 通过"取消"按钮关闭的卸载程序被归入这一类.

### 7.3.1 手动控制, 处理卡住的卸载程序

通过选择列表中的卸载程序, 用户可以使用上面工具栏上的功能.

- 立即运行卸载程序 – 强制卸载程序立即运行. 默认情况下, BCU 会在执行之前检查卸载程序是否与正在运行的卸载程序冲突. 可以在设置中禁用此安全检查. 

- 跳过 – 不要执行卸载程序. 如果卸载程序正在运行, BCU 将停止等待. 

- 终止 – 不要执行卸载程序. 如果卸载程序正在运行, BCU将在继续之前终止它.   

### 7.3.2 中断整个卸载任务

在任何时候都可以通过单击"取消"或尝试关闭窗口中止卸载任务. BCU将在跳过所有剩余的卸载程序之前请求确认.

正在运行的卸载程序不会关闭, BCU将等待它们完成. 如果剩余的卸载程序被卡住, 可能需要手动跳过或终止它们.

## 7.4 残余 / 垃圾删除

![](https://user-images.githubusercontent.com/85151140/122630186-97a98900-d0f4-11eb-879a-0f9d8fdea2bb.png)

一旦卸载完成, BCU将询问是否搜索残余内容. 如果找到, 将显示上述窗口.

可以打开项目的位置并通过上下文菜单查看其详细信息.

导出只会保存窗口中可见的数据(项目路径,置信度等). 这不是备份工具.

### 7.4.1 置信度

所有项目都给予"置信度"评级. 置信度越高, 移除项目就越安全. 默认情况下, 仅选择至少具有"好"可信度的项.

显示不可靠的项目是可能的, 但是删除它们是危险的, 仅建议有经验的用户使用.

### 7.4.2 备份

在删除注册表项之前, BCU将询问是否创建它们的备份.

文件和文件夹被移动到回收站. 如果回收站被禁用或容量不足, 则项目将被永久删除.

# 8 自定义规则, 脚本 和 调整

从BCU版本 4.9 开始, 可以添加自定义检测规则(现在起称为“脚本”), 在应用程序列表上创建自定义条目. 这允许最终用户将自定义规则添加到BCU的安装中, 并在以后自动执行这些规则.

脚本放在BCU安装目录的 Resources\Scripts 文件夹中, 扩展名为.xml. 它们可以放在子文件夹中.

版本4.9中引入的系统调整作为脚本实现, 可以用作示例.

## 8.1 脚本文件规范

脚本是简单的.xml文件, 其中包含在应用程序列表上创建新条目所需的信息以及可选条件.

### 8.1.1 脚本文件示例 (remove-onedrive.xml)

```xml
<script>
    <ConditionScript>remove-onedrive_check.ps1</ConditionScript>
    <Script>remove-onedrive.ps1</Script>
    <DisplayName>OneDrive</DisplayName>
    <Publisher>Microsoft Corporation</Publisher>
    <RatingId>OneDrive</RatingId>
    <AboutUrl>https://onedrive.live.com/</AboutUrl>
    <InstallLocation>Registry::HKEY_CURRENT_USER\SOFTWARE\Microsoft\OneDrive\CurrentVersionPath</InstallLocation>
    <DisplayVersion>Registry::HKEY_CURRENT_USER\SOFTWARE\Microsoft\OneDrive\Version</DisplayVersion>
    <DisplayIcon>Registry::HKEY_CURRENT_USER\SOFTWARE\Microsoft\OneDrive\OneDriveTrigger</DisplayIcon>
</script>
```

### 8.1.2 标准元素

ApplicationUninstallerEntry类的大多数属性, 例如DisplayName, InstallLocation, 都可以通过创建具有该属性名称的元素来分配.

要获取具有示例值的可用元素名称列表, 请打开BCU并选择"文件" > "导出", 或右键单击列表中的任何应用程序并打开"高级复制到剪贴板". 你还可以检查源代码.

### 8.1.3 可用值

大多数元素可以采用任意常量字符串. 它将按原样复制到应用程序列表中的项目, 除非它因某些原因无效.

如果值以 “Registry::” 开始, 它将*被视为值的完整注册表路径*. 指向的值 *将从注册表读取* 代替注册表路径使用.

例如, 在 InstallLocation 元素中使用`Registry::HKEY_CURRENT_USER\SOFTWARE\Microsoft\OneDrive\CurrentVersionPath` 将导致 BCU 从注册表键`HKEY_CURRENT_USER\SOFTWARE\Microsoft\OneDrive`读取名为`CurrentVersionPath`的值并将其内容放入InstallLocation属性中.

### 8.1.4 特殊元素

- Script - PowerShell脚本文件的路径, 该文件将在"卸载"此项时执行. 它覆盖UninstallString和QuietUninstallString元素. 路径是相对于.xml文件的. 必须分配Script或UninstallString. 

- ScriptArgs – 要传递给上述脚本的可选参数. 

- ConditionScript – 将执行的可选PowerShell脚本的路径, 以查看是否应显示此项目. 如果脚本返回错误代码0, 则将显示条目. 如果返回的不是0, 则该项目将不会显示在应用程序列表上. 路径是相对于.xml文件的. 

- ConditionScriptArgs - 要传递给上述脚本的可选参数

- SystemIcon – .Net [系统图标](https://docs.microsoft.com/en-us/dotnet/api/system.drawing.systemicons)之一的可选名. 它覆盖 DisplayIcon 元素. 

# 9 命令行选项

BCUninstaller及其帮助程序的有效命令行选项列表.

## 9.1 BCUninstaller.exe

```
BCUninstaller [drive:][path]filename

[drive:][path] – 指定卸载列表的驱动器和目录.

filename   – 指定卸载列表的文件名

BCUninstaller /sm – 只启动开机启动项管理器. 不枚举已安装的应用程序, 因此启动速度更快. 如果BCU已经在运行,这个开关将被忽略, 运行的实例将被聚焦(也可以使用 /startupmanager)
```

## 9.2 BCU-console.exe

```
BCU-console [help | /?] - 显示帮助 (当前屏幕)

BCU-console uninstall [drive:][path]filename [/Q] [/U] [/V] - 卸载应用程序.

[drive:][path] – 指定卸载列表的驱动器和目录.

filename      – 指定包含要卸载应用程序有关信息的.bcul卸载列表的文件名.

BCU-console export [drive:][path]filename [/Q] [/U] [/V] - 将安装的应用程序数据导出到xml文件.

[drive:][path] – 指定导出时应保存到的驱动器和目录.

filename      – 指定保存导出应用程序信息的.xml文件名称.

开关s:

/Q             - 尽可能使用静默卸载程序 (默认只使用显式).

/U             - 无人值守模式(不要求用户确认). 警告:只在彻底测试后使用. 卸载列表应尽可能具体, 以避免误删. 没有保证, 请谨慎使用.

/V             - 详细日志模式(显示有关当前发生情况的更多信息).
```
返回代码:
0 - 操作已成功完成.
1 - 无效的参数.
1223 - 操作被用户取消.

例子:
BCU-console uninstall “D:\Test\my_list.bcul” /Q /U
BCU-console export out.xml

## 9.3 StoreAppHelper.exe

StoreAppHelper /query
StoreAppHelper /uninstall FullName

query  – 返回当前用户已安装的应用商店应用的列表.
uninstall – 卸载由其名指定的单个应用商店应用程序.

返回代码:
0 - 操作已成功完成.
1627 - 发生意外错误.
10022 - 无效的参数.

## 9.4 SteamHelper.exe

SteamHelper u[ninstall] [/s[ilent]] AppID
SteamHelper i[nfo] AppID
SteamHelper l[ist]
SteamHelper steam

AppID - Steam 应用程序ID.
u[ninstall] - 卸载一个 Steam 应用.
i[nfo] - 显示关于一个 Steam 应用的信息.
l[ist] - 列出 Steam 应用ID.
steam - 显示 Steam 安装位置.
s[ilent] - 不提示任何用户输入.

返回代码:
0 - 操作已成功完成.
59 - 发生意外错误.
1223 - 操作被用户取消.
10022 - 无效的参数.

## 9.5 OculusHelper.exe

OculusHelper /query
OculusHelper /uninstall CanonicalName

query  – 返回当前用户已安装的Oculus应用程序列表.
uninstall – 卸载由CanonicalName指定的单个应用商店应用程序.

返回代码:
0 - 操作已成功完成.
1627 - 发生意外错误.
10022 - 无效的参数.

## 9.6 UninstallerAutomatizer.exe

UninstallerAutomatizer UninstallerType [/K] UninstallCommand

UninstallerType - 卸载程序的类型, 取自UninstallerType枚举. 在写入时, 只支持"Nsis".
K  - 如果自动卸载失败, 终止卸载程序.
UninstallCommand - 带可选参数的目标卸载程序路径.

返回代码:
0 - 操作已成功完成.
1627 - 发生意外错误.
10022 - 无效的参数.
